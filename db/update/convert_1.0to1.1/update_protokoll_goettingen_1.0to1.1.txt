Updateprotokoll (Göttingen)

Datum: 08.04.04
Server: www.goettingen.studip.de
Ursprungsversion: 1.0
Zielversion: 1.1 (cvs vom 08.04.04)
siehe migration.sql für SQL Befehle / Ablauf

Anmerkungen:

Achtung: Dieses Updateprotokoll soll Updates von einer Stud.IP Version auf die andere erleichtern. Der hier beschriebene
Ablauf wurde in dieser Reihenfolge auf der Göttinger Referenz-Installation getestet. Dennoch kann es im Einzelfall zu Abweichungen
kommen (insbesondere, falls eigene Anpassungen vorgenommen wurden).

Ausgangssituation:

Auf dem Server ist die Version 1.0 ohne spezielle Anpassungen installiert. 
Es soll die Version 1.1 mit sämtlichen in der Distribution enthaltenen Modulen installiert werden.

Vorbereitungen:

Zunächst werden Datenbank und Webserver heruntergefahren. Anschließend wird ein Backup der Datenbank und aller Scripte im vorliegenden 
Zustand vorgenommen. Die neue Version wird über die alte vorhandenen Version installiert - auf diese Weise bleiben die Konfigurationsdateien 
local.inc und config.inc.php erhalten. Weitere eigene Scripte, die nur auf diesem Server zum Einsatz kommen, bleiben ebenfalls erhalten.
Aktualisiert werden muss das Stud.IP-Webroot und das Verzeichnis der Php-Lib.
Zum Einsatz kommen die entsprechenden Version der CVS-Module studip und studip-phplib aus dem CVS vom 29.12.03 (Version 1.0beta).

PHP-Module:

Die Version 1.1 benötigt keine neuen PHP-Module oder andere Erweiterungen (einen Überblick über alle benötigten PHP-Module, Zusatzprogramme
und andere Erweiterungen wird in der Datei "studip_installation_guide.txt" im Verzeichnis studip-doc der Distribution gegeben).
Zu beachten ist lediglich, dass nun Imagemagik bzw. die gd-Erweiterung für den Bildupload von persönlichen Bildern 
verwendet werden. Sollte dieser im Ausgangszustand nicht installiert gewesen sein, muss die Installation von Imagemagik zum Betrieb der
1.1 auf jeden Fall vorgenommen werden.

Anpassung der Konfigurationsdateien:

Die Konfigurationsdateien local.inc im Verzeichnis der php-lib und die config.inc im Stud.IP-Root Verzeichnis müssen mit dem aktuellen
Stand der entsprechenden Distributionsversionen abgeglichen werden. Dabei können die alten Konfigurationsdateien als Ausgangszustand 
genommen werden und neu hinzugekommene Werte ergänzt (und nach eigenen Wünschen angepasst) sowie alte Einträge entfernt werden. 
Je nach Umfang der eigenen Anpassungen kann natürlich auch die aktuelle Distributionsversion eingespielt werden und alte Einträge wieder 
gesetzt werden. Dabei muss jedoch sehr genau darauf geachtet werden, dass keine Inkonsitenzen zwischen der alten und der neuen Version 
auftreten.
Es empfielt sich, den Abgleich der neuen Distributionsversionen und der eigenen Datei mit einem Differ vorzunehmen.

Datenbankupdate:

Das Datenbankupdate erfolgt in der angegebenen Reihenfolge (in Klammern stehen die Verweise auf die jeweiligen Abschnitte des
Migrationsscripts):

* neue Tabelle für Semesterverwaltung in der Datenbank anlegen (#1)
* neue Tabelle für die Ferien in der Datenbank anlegen (#2)
* neue Tabelle für Konfiguratiuonssystem (zur Zeit noch im Aufbau) anlegen (#3)
* Konvertierungen für das Eintragen der alten Semester- und Feriendaten in die Datenbank
  Script: convert_semester.php (#4)
  Nach dem Ausführen sollten die konvertierten Semestereinträge überprüft werden und das Funktionieren
  der Semestereinbindung nun aus der Datenbank mit einigen Veranstaltungen gestetet werden.
  ACHTUNG: Wenn die Konvertierung erfolgreich vorgenommen wurde, müssen die Einträge zu Semestern und Ferien
  aus der config.inc.php entfernt werden.
* Änderungen an den Tabellen der Ressourcenverwaltung vornehmen (#5)
  ACHTUNG: Wenn die neue Funktionalität für eine zentrale Raumverwaltung/Raumwünsche genutzt werden soll,
  müssen weitere Konfigurationsoptionen in der Ressourcenverwaltung unter "Anpassen" vorngenommen werden.
  Die default-Einträge sollten allerdings zunächst gesetzt werden:
* Default-Einträge für Ressourcenverwaltung setzen (#6)
* neue Tabellen für Evaluationsmodul anlegen (#7)
* Default-Einträge für Evaluationsmodul anlegen (#8)
* Änderungen an der Dateiverwaltung (#9)
* Änderungen an der Literaturverwaltung für Einrichtungsfunktionen (#10)
* Änderungen für eMailweiterleitung (#11)


Sonstige Änderungen:

- Für die neue Smiley-Verwaltung muss der Webserver Schreibrechte auf der Verzeichnis <studip-root>/pictiures/smileys erhalten,
  so dass Smileys im System hochgeladen werden können.